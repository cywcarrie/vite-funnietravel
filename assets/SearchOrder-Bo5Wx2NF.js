import{_ as I,g as p,c as i,d as y,a as t,w as k,b as o,i as h,v as w,t as n,F as V,n as A,z as E,S as a,r as P,o as c,j as L}from"./index-CfIPeRLi.js";import{V as O}from"./VueLoading-D-FhoWGy.js";const T={BASE_URL:"/vite-funnietravel/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"funnietravel-api"},C={components:{VueLoading:O},setup(){const l=L("$axios"),e=p(""),b=p(null),s=p(!1),{VITE_APP_API:f,VITE_APP_PATH:x}=T;function u(){if(!e.value.trim()){a("error","請輸入訂單編號");return}const m=`${f}api/${x}/order/${e.value}`;s.value=!0,l.get(m).then(r=>{const d=r.data;d.success&&d.order&&d.order.id?(b.value=d.order,a("success","查詢訂單成功")):a("error",d.message||"查無此訂單，請確認訂單編號")}).catch(r=>{var v,g,_;if(((v=r.response)==null?void 0:v.status)===404)a("error","找不到該訂單");else{const S=((_=(g=r.response)==null?void 0:g.data)==null?void 0:_.message)||"發生錯誤，請稍後再試";a("error",S)}}).finally(()=>{s.value=!1})}return{orderId:e,order:b,isLoading:s,getSearchOrder:u}}},D={class:"mb-5"},N={class:"container"},R={"aria-label":"breadcrumb",style:{"--bs-breadcrumb-divider":"'>'"},class:"mt-3 mb-md-4 d-flex justify-content-start"},j={class:"breadcrumb"},B={class:"breadcrumb-item"},U={class:"container mt-5 search-card"},F={class:"card shadow-sm border-0 rounded-4 overflow-hidden"},H={class:"card-body p-4 bg-light"},M={class:"input-group d-none d-md-flex mb-5"},q={class:"d-flex flex-column gap-2 w-100 mx-auto mb-5 d-md-none"},z={key:0},G={class:"my-5 row justify-content-center"},J={class:"col-lg-8"},K={class:"card border-0 rounded-4 shadow-sm mb-5"},Q={class:"card-body bg-light border-0 rounded-4 rounded-top-0 px-md-5 py-md-4"},W={class:"mb-4"},X={class:"border border-primary rounded-4 p-4 bg-white"},Y={class:"table align-middle table-borderless mb-4"},Z={class:"text-center text-primary fw-bold"},$={class:"text-center text-nowrap"},tt={class:"text-center text-nowrap"},et={class:"border-top"},st={class:"fs-5 text-primary fw-bold text-nowrap"};function rt(l,e,b,s,f,x){const u=P("VueLoading"),m=P("RouterLink");return c(),i(V,null,[y(u,{active:s.isLoading},null,8,["active"]),e[17]||(e[17]=t("div",{class:"my-5 position-relative banner container-fluid",style:{background:"linear-gradient(to right, #90afc5, #336b87)"}},[t("h2",{class:"position-absolute text-center text-white fw-bolder banner-title fs-2"},"查詢訂單")],-1)),t("section",D,[t("div",N,[t("nav",R,[t("ol",j,[t("li",B,[y(m,{to:"/",class:"text-dark hover-nav fw-bold"},{default:k(()=>e[4]||(e[4]=[o("首頁")])),_:1})]),e[5]||(e[5]=t("li",{class:"breadcrumb-item active","aria-current":"page"},"查詢訂單",-1))])]),t("div",U,[t("div",F,[t("div",H,[e[8]||(e[8]=t("h2",{class:"text-center fw-bold mb-4"},[t("i",{class:"bi bi-search me-2"}),o("查詢我的訂單")],-1)),e[9]||(e[9]=t("p",{class:"text-body-secondary text-center small mb-4"}," 請輸入您的訂單編號以查詢詳細資訊 ",-1)),t("div",M,[e[7]||(e[7]=t("span",{class:"input-group-text bg-white border-end-0"},[t("i",{class:"bi bi-receipt"})],-1)),h(t("input",{type:"text",class:"form-control border-start-0","onUpdate:modelValue":e[0]||(e[0]=r=>s.orderId=r),placeholder:"請輸入訂單編號"},null,512),[[w,s.orderId]]),t("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...r)=>s.getSearchOrder&&s.getSearchOrder(...r))},e[6]||(e[6]=[t("i",{class:"bi bi-arrow-right-circle me-1"},null,-1),o("查詢 ")]))]),t("div",q,[h(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=r=>s.orderId=r),placeholder:"請輸入訂單編號"},null,512),[[w,s.orderId]]),t("button",{class:"btn btn-primary",onClick:e[3]||(e[3]=(...r)=>s.getSearchOrder&&s.getSearchOrder(...r))},"查詢")])])])]),s.order?(c(),i("div",z,[t("div",G,[t("div",J,[t("div",K,[e[16]||(e[16]=t("div",{class:"card-header rounded-4 rounded-bottom-0 bg-gradient bg-primary text-white text-center py-4"},[t("h4",{class:"mb-0"},[t("i",{class:"bi bi-receipt-cutoff me-2"}),o("訂單資訊")])],-1)),t("div",Q,[t("div",W,[e[12]||(e[12]=t("p",{class:"small text-body-secondary"},[t("i",{class:"bi bi-info-circle me-1"}),o(" 訂購人資訊僅顯示姓名及電子郵件，其他資訊將不會公開 ")],-1)),t("p",null,[e[10]||(e[10]=t("strong",null,[t("i",{class:"bi bi-person me-2"}),o("姓名：")],-1)),o(n(s.order.user.name),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,[t("i",{class:"bi bi-envelope me-2"}),o("Email：")],-1)),o(n(s.order.user.email),1)])]),t("div",X,[e[15]||(e[15]=t("h5",{class:"mb-3 fw-bold text-primary"},[t("i",{class:"bi bi-list-ul me-2"}),o("訂單明細 ")],-1)),t("table",Y,[e[14]||(e[14]=t("thead",{class:"text-center table-light"},[t("tr",null,[t("th",{class:"text-nowrap"},"行程名稱"),t("th",{class:"text-center text-nowrap"},"數量"),t("th",{class:"text-nowrap"},"價格")])],-1)),t("tbody",null,[(c(!0),i(V,null,A(s.order.products,r=>(c(),i("tr",{key:r.id},[t("td",Z,n(r.product.title),1),t("td",$,n(r.qty)+"/"+n(r.product.unit),1),t("td",tt,n(l.$format.currency(r.final_total)),1)]))),128))]),t("tfoot",null,[t("tr",et,[e[13]||(e[13]=t("td",{colspan:"2",class:"text-end fw-bold text-nowrap"},"總計",-1)),t("td",st,n(l.$format.currency(s.order.total)),1)])])])])])])])])])):E("",!0)])])],64)}const dt=I(C,[["render",rt]]);export{dt as default};
